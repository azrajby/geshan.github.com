<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <title>Don&#8217;t code your microservice like a monolith, keep it maintainable not over-engineered - Geshan&#8217;s Blog</title>
  <meta name="author" content="Geshan Manandhar">

  
  

  <link href="/assets/bootstrap/dist/css/bootstrap.united.min.css" rel="stylesheet" type="text/css">

<meta property="og:image:width" content="450"/>
<meta property="og:image:height" content="298"/>
<meta name="p:domain_verify" content="e654c68562abebfa25c291f59d7d00e8"/>

<link rel="apple-touch-icon" sizes="57x57" href="images/icons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="images/icons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="images/icons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="images/icons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="images/icons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="images/icons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="images/icons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="images/icons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="images/icons/apple-icon-180x180.png">

<link rel="icon" type="image/png" sizes="192x192"  href="images/icons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="images/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="images/icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="images/icons/favicon-16x16.png">

<link rel="manifest" href="manifest.json">

<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://geshan.com.np/blog/2018/10/dont-code-your-microservice-like-a-monolith">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Geshan's Blog" type="application/atom+xml">

  <!-- http://opengraphprotocol.org/ -->
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://geshan.com.np/blog/2018/10/dont-code-your-microservice-like-a-monolith">
  <meta property="og:title" content="Don't code your microservice like a monolith, keep it maintainable &hellip; - Geshan's Blog">
  

  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  
   <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56310304-1', 'auto');
    ga('send', 'pageview');

  </script>


</head>

  <body   >
    <a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Geshan&#8217;s Blog</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a rel="index" href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="geshan.com.np" />
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-8" itemscope itemtype="http://schema.org/Blog">
    <meta itemprop="name" content="Geshan's Blog" />
    <meta itemprop="description" content="A blog about technology, open source, web development etc." />
    <meta itemprop="url" content="https://geshan.com.np" />
    <article class="hentry" role="article" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
      
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-10-12T15:54:07+11:00"  data-updated="true" itemprop="datePublished dateCreated"><time class='entry-date' datetime='2018-10-12T15:54:07+11:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>3:54 pm</span></time></time>
        
           | <a href="#disqus_thread" itemprop="discussionUrl"
             data-disqus-identifier="https://geshan.com.np">Comments</a>
        
      </p>
    
    
    <h1 class="entry-title" itemprop="name headline">
        Don&#8217;t code your microservice like a monolith, keep it maintainable not over-engineered
        
    </h1>
    
  </header>


<div class="entry-content clearfix" itemprop="articleBody description"><p>Will you use a gun to kill a fly? The answer is NO. The same thing goes when you want to write a microservice application that is going to be maximum of 10K lines of code. Don&rsquo;t over-engineer it. Ok, you have been writing and maintaining large code bases. Some might be 100K+ lines of code but you need to get over your habits and think differently. This post helps you unravel the mysteries of writing small and maintainable microservices. The suggestions are opinionated but it is in practice in a million dollar business.</p>

<p><img class="center" src="/images/microservice-code/lego.jpg" title="Do not code your microservice like a monolith, keep it maintainable not over-engineered" alt="Do not code your microservice like a monolith, keep it maintainable not over-engineered"></p>

<!-- more -->


<h2>TLDR;</h2>

<blockquote><p>Microservices are small software systems. You can safely ditch MVC. Say no to ORM and also not take the design pattern baggage for microservices. Focus on code performance, readability, and maintainability not some old rules and patterns. Those patterns were made when people were not doing microservices.</p></blockquote>

<h2>Why write microservices in the first place?</h2>

<p>Microservices architecture, in my opinion, is breaking one or more monoliths into multiple smaller systems. These are more maintainable, independently developed and deployed pieces of software based on business functions. These smaller (presumably “micro”) systems should focus on only one business function and do it well. The catch here is &ldquo;micro&rdquo;, these pieces should ideally be under 10K lines of code.</p>

<p>As they are independent it helps the business release features faster. The shipments team is not dependent on the checkout team. Something deployed on the shipments app is never going to break checkout. It becomes very decoupled. The blast radius of each change is controlled. That is the reason for rapid microservice adoption.</p>

<p>Now let&rsquo;s look at the ways you were used to doing things and why it makes less sense in this microservices era.</p>

<h2>Do you need MVC?</h2>

<p>Model-View-Controller, I got introduced to it in 2007 or maybe a bit earlier. Then I used to think it was the silver bullet to all software architecture issues. I don&rsquo;t hold that opinion anymore. Yes, you used to work with Java or PHP and every other framework was MVC based. Now, you don&rsquo;t need to be strict about MVC anymore. Focus on clarity and getting things done.</p>

<p>Use controllers if you want and if it still makes sense. Think like my app gets HTTP request and it has to give back HTTP response. Do think of having a backend API and frontend(s) consuming it. Check the code below, it is surely not MVC:</p>

<script src="https://gist.github.com/geshan/1f76e5ebb3c15fd3c147c6c97420f923.js"></script>


<p>You can see the full app <a href="https://github.com/geshan/currency-api">here</a>. Veify the structure it is not MVC :)</p>

<p>So rather than doing an effort to get precise lines of M-V-C, write tests, implement continuous integration. Add some logs and monitoring to the app. Make the code maintainable, keep it as lean and simple as possible.</p>

<h2>Don&rsquo;t take on the ORM overhead</h2>

<p>Object Relation Mapping (ORM) when I first saw an ORM in action, I said to myself this is one of the best things ever known to programmers. 10+ years later I would be cautious to suggest an ORM to any software engineer. Last year I refactored a full ORM implementation to a raw SQL query way and it made that part of the application perform 20% faster. On top of it, the database transactions were evident and the code was far more readable hence maintainable.</p>

<p>Data mapper or Active record both bring their own opinions, ways of doing things and extra weight. This not only causes performance issues but also code readability suffers. Think of the pre and post hooks/event listener Doctrine has, they work like magic and it is always tricky to understand magic.</p>

<p><img class="center" src="/images/microservice-code/pot-on-head.jpg" title="Do not code your microservice like a monolith, keep it maintainable not over-engineered" alt="Do not code your microservice like a monolith, keep it maintainable not over-engineered"></p>

<p>Just try this, explain how an ORM related insert code works VS how a simple and straightforward INSERT SQL query works to a beginner/junior software engineer. You will already regret using that ORM. Especially in the context of microservices ORM is a clear overhead. The microservice is anticipated to be maximum of 10K lines of code and affect hardly 10 tables so just don&rsquo;t use an ORM, period.</p>

<h2>Design patterns might be a baggage</h2>

<p>I am not saying that you don&rsquo;t need to learn about <a href="https://en.wikipedia.org/wiki/Software_design_pattern">software design patterns</a>. You should know about SOLID, law of Demeter, factory pattern, strategy pattern, singleton, adapter pattern etc. Well, most of these make sense if you do object-oriented programming right? What if you write a microservice in Node JS that is 1k lines of code spread across ~7 files. It does one small slice of the business function. All these patterns become nice to know stuff at that point.</p>

<p>Design Patterns are relevant for a code base that is already big and in the next 6-12 months is going to be bigger, your usual monolith. They can turn out to be &ldquo;extra baggage&rdquo; for a service that is 100s of lines of code now and will become 1000s of lines of code in the next 6-12 months. We never foresee it to be bigger than that because to do that other part we will have another microservice. So keep your microservice code fat free and well tested.</p>

<p><img class="center" src="/images/microservice-code/baggage.jpg" title="Do not code your microservice like a monolith, keep it maintainable not over-engineered" alt="Do not code your microservice like a monolith, keep it maintainable not over-engineered"></p>

<h2>Conclusion</h2>

<p>If you still want to code your microservice like the last monolith you worked on maybe you are doing something wrong. Think of it again, if you go for a day trip you don&rsquo;t pack and carry things like you are going for a 2 weeks vacation. Think of code performance and maintainability, let the data speak for you and break the rules. Happy software engineering!</p>
</div>


      <footer>
        <p class="meta text-muted">
          
  

<span class="glyphicon glyphicon-user"></span> <span class="byline author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person">Posted by <span class="fn" itemprop="name">Geshan Manandhar</span></span>

          












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2018-10-12T15:54:07+11:00"  data-updated="true" itemprop="datePublished dateCreated"><time class='entry-date' datetime='2018-10-12T15:54:07+11:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>12</span><span class='date-suffix'>th</span>, <span class='date-year'>2018</span></span> <span class='time'>3:54 pm</span></time></time>
          

<span class="glyphicon glyphicon-tags"></span>&nbsp;
<span class="categories">
  
    <a class='category' href='/blog/categories/microservice/'>microservice</a>, <a class='category' href='/blog/categories/misc/'>misc</a>, <a class='category' href='/blog/categories/technology/'>technology</a>
  
</span>


        </p>
        
          <div class='shareaholic-canvas' data-app='share_buttons' data-app-id='11665322'></div>

        
        
          <ul class="meta text-muted pager">
            
            <li class="previous"><a href="/blog/2018/10/why-use-docker-3-reasons-from-a-development-perspective/" title="Previous Post: Why use docker? 3 reasons from a development perspective">&laquo; Why use docker? 3 reasons from a development perspective</a></li>
            
            
          </ul>
        
      </footer>
    </article>
    
      <section>
        <h1>Comments</h1>
        <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
      </section>
    
  </div>

  
  <aside class="sidebar col-md-4">
    
      <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item active" href="/blog/2018/10/dont-code-your-microservice-like-a-monolith/">Don&#8217;t code your microservice like a monolith, keep it maintainable not over-engineered</a>
    
    <a class="list-group-item " href="/blog/2018/10/why-use-docker-3-reasons-from-a-development-perspective/">Why use docker? 3 reasons from a development perspective</a>
    
    <a class="list-group-item " href="/blog/2018/10/dont-just-learn-a-new-language-slash-framework/">Don&#8217;t just learn a new language/framework, implement it as a running open source project</a>
    
    <a class="list-group-item " href="/blog/2018/09/7-practical-steps-to-land-your-first-tech-job/">5 practical steps to land your first tech job</a>
    
    <a class="list-group-item " href="/blog/2018/05/how-to-do-a-zero-downtime-database-db-migration-schema-change-with-a-practical-example/">How to do a zero downtime database (DB) migration (schema change) with a practical example</a>
    
  </div>
</section>
<section class="panel panel-default">
    <div class="panel-heading">
        <h3 class="panel-title">Categories</h3>
    </div>
    <div class="list-group">
        
        
        <a class="list-group-item " href="/blog/categories/misc/">
            <span class="badge">191</span>
            misc
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/mobiles/">
            <span class="badge">8</span>
            mobiles
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/technology/">
            <span class="badge">133</span>
            technology
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/foss/">
            <span class="badge">15</span>
            foss
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/drupal/">
            <span class="badge">37</span>
            drupal
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/programming/">
            <span class="badge">26</span>
            programming
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/tutorial/">
            <span class="badge">20</span>
            tutorial
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/about-me/">
            <span class="badge">2</span>
            about me
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/learn-php/">
            <span class="badge">4</span>
            learn php
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/php/">
            <span class="badge">21</span>
            php
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/codeigniter/">
            <span class="badge">1</span>
            codeigniter
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/git/">
            <span class="badge">8</span>
            git
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/apps/">
            <span class="badge">4</span>
            apps
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/android/">
            <span class="badge">2</span>
            android
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/infographics/">
            <span class="badge">7</span>
            infographics
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/testing/">
            <span class="badge">5</span>
            testing
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/javascript/">
            <span class="badge">1</span>
            javascript
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/symfony/">
            <span class="badge">3</span>
            symfony
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/talks/">
            <span class="badge">11</span>
            talks
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/laravel/">
            <span class="badge">2</span>
            laravel
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/deployment/">
            <span class="badge">6</span>
            deployment
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/logging/">
            <span class="badge">2</span>
            logging
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/api/">
            <span class="badge">1</span>
            api
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/docker/">
            <span class="badge">4</span>
            docker
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/database/">
            <span class="badge">1</span>
            database
        </a>
        
        
        <a class="list-group-item " href="/blog/categories/microservice/">
            <span class="badge">1</span>
            microservice
        </a>
        
    </div>
</section>
<section class="social aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">
    Follow me!
  </h1>
  <ul class="unstyled">
    
    
    <li><a class="github" href="//github.com/geshan" target="_blank"><i class="icon-github"></i> Github</a></li>
    
    
    <li><a class="linkedin" href="//linkedin.com/in/geshan" target="_blank"><i class="icon-linkedin-sign"></i> LinkedIn</a></li>
    
    
    <li><a class="twitter" href="//twitter.com/geshan" target="_blank"><i class="icon-twitter"></i> Twitter</a></li>
    
  </ul>
</section>


    
  </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2018 - Geshan Manandhar<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

</footer>
    

<script type="text/javascript">
      var disqus_shortname = 'geshanblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://geshan.com.np/blog/2018/10/dont-code-your-microservice-like-a-monolith/';
        var disqus_url = 'https://geshan.com.np/blog/2018/10/dont-code-your-microservice-like-a-monolith/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>






<script>
    window.addEventListener('load', function () {
        if ('serviceWorker' in navigator) {
    
            var isWorkboxEnabled = false;
            var serviceWorker = (isWorkboxEnabled) ? 'service-worker-workbox.js' : 'service-worker-vanilla.js';
    
            // Register the ServiceWorker
            navigator.serviceWorker.register(serviceWorker, {
                scope: './'
            }).then(function(reg) {
                console.log('Service worker has been registered for scope:', reg.scope);
            }).catch(function (error) {
                // registration failed
                console.log('Service worker registration failed with: ', error);
            });
        }
    });
</script>

<script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>


  </body>
</html>
